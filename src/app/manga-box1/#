import { Component } from '@angular/core';
import { MangaServiceService } from '../manga-service.service';
import { Manga } from './manga';
import { CommonModule} from '@angular/common';
import { FormsModule} from '@angular/forms';

@Component({
  selector: 'app-manga-box1',
  imports: [CommonModule,FormsModule],
  templateUrl: './manga-box1.component.html',
  styleUrl: './manga-box1.component.css',
  providers: [MangaServiceService]
})
export class MangaBox1Component {
  mangaData: any;
  mangaTitle = "";
  mangaDesc = "";

  inputValue = "";

  mangaFace: Manga[] = [{description: "", title: "fuck",image: ""}];

  handleClick(value:string){
    this.mangaTitle = value;
    console.log(this.mangaTitle);
    this.loadData();
  }


  constructor(private mangaInfoService: MangaServiceService ) { }


 loadData(){
    this.mangaInfoService.getMangaInformation(this.mangaTitle).subscribe(data => {
      this.mangaData = data;
      if (this.mangaData.data["length"] > 0 ) {
        console.log(this.mangaData);

        this.loadMangaInfos();

      }else{
        this.mangaTitle = "No results";
      }

    });

  }

clearManga() {
  this.mangaFace.splice(0,this.mangaFace.length);
}

 loadMangaInfos() {

      this.clearManga();

      for (let i =0;i<this.mangaData.data.length;i++) {
        let manga_title = this.mangaData.data[i]["attributes"]["title"]["en"];
        let manga_desc = this.mangaData.data[i]["attributes"]["description"]["en"];

        const newManga: Manga = {
          title:manga_title,
          description: manga_desc,
          image: "",
        };

        this.mangaFace.push(newManga);

        console.log(this.mangaFace);
      }





  }

}
